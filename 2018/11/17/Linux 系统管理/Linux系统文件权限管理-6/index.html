<!DOCTYPE html>













<html class="theme-next gemini" lang>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">


























<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=7.0.1">











<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '7.0.1',
    sidebar: {"position":"left","display":"hide","offset":12,"onmobile":false,"dimmer":false},
    back2top: true,
    back2top_sidebar: true,
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":false,"async":false,"transition":{"post_block":"expandIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="Linux 是一套免费使用和自由传播的类Unix操作系统,是一个基于POSIX和UNIX的多用户、多任务、支持多线程和多CPU的操作系统.它能运行主要的UNIX工具软件、应用程序和网络协议.它支持32位和64位硬件.Linux继承了Unix以网络为核心的设计思想,是一个性能稳定的多用户网络操作系统. Linux操作系统是多任务(Multi-tasks)多用户(Multi-users)分时操作系统,">
<meta name="keywords" content="Linux 系统管理">
<meta property="og:type" content="article">
<meta property="og:title" content="Linux系统文件权限管理(6)">
<meta property="og:url" content="https://www.mkdirs.com/2018/11/17/Linux 系统管理/Linux系统文件权限管理-6/index.html">
<meta property="og:site_name" content="我的个人博客">
<meta property="og:description" content="Linux 是一套免费使用和自由传播的类Unix操作系统,是一个基于POSIX和UNIX的多用户、多任务、支持多线程和多CPU的操作系统.它能运行主要的UNIX工具软件、应用程序和网络协议.它支持32位和64位硬件.Linux继承了Unix以网络为核心的设计思想,是一个性能稳定的多用户网络操作系统. Linux操作系统是多任务(Multi-tasks)多用户(Multi-users)分时操作系统,">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2019-04-16T12:34:48.575Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Linux系统文件权限管理(6)">
<meta name="twitter:description" content="Linux 是一套免费使用和自由传播的类Unix操作系统,是一个基于POSIX和UNIX的多用户、多任务、支持多线程和多CPU的操作系统.它能运行主要的UNIX工具软件、应用程序和网络协议.它支持32位和64位硬件.Linux继承了Unix以网络为核心的设计思想,是一个性能稳定的多用户网络操作系统. Linux操作系统是多任务(Multi-tasks)多用户(Multi-users)分时操作系统,">



  <link rel="alternate" href="/atom.xml" title="我的个人博客" type="application/atom+xml">




  <link rel="canonical" href="https://www.mkdirs.com/2018/11/17/Linux 系统管理/Linux系统文件权限管理-6/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>Linux系统文件权限管理(6) | 我的个人博客</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="default">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">我的个人博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>

      
      
    </ul>
  

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.mkdirs.com/2018/11/17/Linux 系统管理/Linux系统文件权限管理-6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="王瑞">
      <meta itemprop="description" content="记录点滴技术成长之路">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="我的个人博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Linux系统文件权限管理(6)

              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2018-11-17 09:26:11" itemprop="dateCreated datePublished" datetime="2018-11-17T09:26:11+08:00">2018-11-17</time>
            

            
              

              
                
                <span class="post-meta-divider">|</span>
                

                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                
                  <span class="post-meta-item-text">更新于</span>
                
                <time title="修改时间：2019-04-16 20:34:48" itemprop="dateModified" datetime="2019-04-16T20:34:48+08:00">2019-04-16</time>
              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Linux-系统管理/" itemprop="url" rel="index"><span itemprop="name">Linux 系统管理</span></a></span>

                
                
              
            </span>
          

          
            
            
          

          
          

          

          

          

        </div>
      </header>
    
    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>Linux 是一套免费使用和自由传播的类Unix操作系统,是一个基于POSIX和UNIX的多用户、多任务、支持多线程和多CPU的操作系统.它能运行主要的UNIX工具软件、应用程序和网络协议.它支持32位和64位硬件.Linux继承了Unix以网络为核心的设计思想,是一个性能稳定的多用户网络操作系统.</p>
<p>Linux操作系统是多任务(Multi-tasks)多用户(Multi-users)分时操作系统,linux操作系统的用户就是让我们登录到linux的权限,每当我们使用用户名登录操作系统时,linux都会对该用户进行认证、授权审计等操作,本章主要内容就是围绕着权限来讲解的,我会讲解Linux系统中的所有常用权限包括,普通权限/隐藏权限/特殊权限/ACL/SUDO/SELinux,等的设置与使用技巧.</p>
<a id="more"></a>
<p><br></p>
<h2 id="Linux-文件普通权限"><a href="#Linux-文件普通权限" class="headerlink" title="Linux 文件普通权限"></a>Linux 文件普通权限</h2><p>说到权限,首先我们先来了解一下Linux系统的基础权限吧,这里的内容几乎在使用Linux系统是经常用得到,所以请好好把握.首先,我们要来谈一谈,这个文件的权限要如何针对这些所谓的『使用者』与『群组』来设定呢,这个部分是相当重要的,因为文件的权限与属性是学习Linux的一个相当重要的关卡,如果没有这部份的概念,那么你将老是听不懂别人在讲什么,尤其是当你在你的屏幕前面出现了『Permission deny』的时候,不要担心，『肯定是权限设定错误』啦,好了,闲话不多聊,赶快来瞧一瞧先.</p>
<p>我们使用<code>ls -l</code>命令查询出了一下内容,下面我们就分别介绍一下下面内容的含义吧.<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># ls -lh</span></span><br><span class="line"></span><br><span class="line">d   rwxr-xr-x.  2   root   root       6   Nov 17 05:22   lyshark_dir</span><br><span class="line">-   rw-r--r--.  1   root   root       0   Nov 17 05:22   lyshark_file</span><br><span class="line">l   rwxrwxrwx.  1   root   root      12   Nov 17 05:22   lyshark_link -&gt; lyshark_file</span><br><span class="line">b   rw-rw----.  1   root   disk       8   Nov 17 05:21   /dev/sda</span><br><span class="line">c   rw-rw-rw-.  1   root   root       1   Nov 17 05:21   /dev/zero</span><br><span class="line">↑   ↑           ↑     ↑     ↑         ↑         ↑            ↑</span><br><span class="line">①   ②           ③     ④     ⑤         ⑥         ⑦            ⑧</span><br></pre></td></tr></table></figure></p>
<blockquote>
<p><strong>第一项：</strong>代表这个文件的类型与权限(permission):</p>
<blockquote>
<p>当为[ d ]则是目录,例如上为『lyshark_dir』的那一行<br>当为[ - ]则是文件,例如上表名为『lyshark_file』那一行<br>若是[ l ]则是链接,例如上为『lyshark_link』的那一行<br>若是[ b ]则是设备,表示可供储存的接口设备(可随机存取装置)<br>若是[ c ]则表串口,的串行端口设备,例如键盘、鼠标,显示器</p>
</blockquote>
</blockquote>
<blockquote>
<p><strong>第二项：</strong>以三个为一组,且均为『rwx』的三个参数的组合,r=读取,w=写入,x=执行:</p>
<blockquote>
<p>当为[ r ]则是读取权限,此权限还可以用数字4代表.<br>当为[ w ]则是写入权限,此权限还可以用数字2代表.<br>若是[ x ]则是执行权限,此权限还可以用数字1代表.</p>
</blockquote>
</blockquote>
<blockquote>
<p><strong>第三项：</strong>代表文件的链接数,引用计数(文件:硬链接数 目录:目录下的子目录个数).<br><strong>第四项：</strong>代表文件的文件的所有者(属主)<br><strong>第五项：</strong>代表文件的文件的所属组(属组)<br><strong>第六项：</strong>代表文件大小(默认单位字节byte)<br><strong>第七项：</strong>代表文件最后一次修改时间<br><strong>第八项：</strong>代表文件的文件名</p>
</blockquote>
<h3 id="◆chmod-更改目录权限◆"><a href="#◆chmod-更改目录权限◆" class="headerlink" title="◆chmod 更改目录权限◆"></a>◆chmod 更改目录权限◆</h3><p>chmod命令用来变更文件或目录的权限,在UNIX系统家族里,文件或目录权限的控制分别以读取、写入、执行3种一般权限来区分,另有3种特殊权限可供运用,用户可以使用chmod指令去变更文件与目录的权限,设置方式采用文字或数字代号皆可,符号连接的权限无法变更,如果用户对符号连接修改权限,其改变会作用在被连接的原始文件.</p>
<p>下面,来看一下这个命令的参数.<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># chmod --help</span></span><br><span class="line"></span><br><span class="line">命令语法：[ chmod [选项] [ugo][+-][rwx] 文件或目录 ]</span><br><span class="line"></span><br><span class="line">        U               <span class="comment">#属主,可用4代表</span></span><br><span class="line">        G               <span class="comment">#属组,可用2代表</span></span><br><span class="line">        O               <span class="comment">#其他人,可用1代表</span></span><br><span class="line"></span><br><span class="line">        -c              <span class="comment">#显示权限修改过程,但仅显示改变的</span></span><br><span class="line">        -v              <span class="comment">#显示权限修改过程,显示所有过程</span></span><br><span class="line">        -f              <span class="comment">#不显示错误信息</span></span><br><span class="line">        -R              <span class="comment">#递归设置权限</span></span><br></pre></td></tr></table></figure></p>
<p><strong>实例1：</strong>使用<code>chmod -Rv</code>给指定目录设置一个777的权限.<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># ls -lh lyshark_dir</span></span><br><span class="line">total 0</span><br><span class="line">drwxr-xr-x. 2 root root  6 Nov 17 05:22 lyshark_dir</span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># chmod -Rv 777 lyshark_dir/</span></span><br><span class="line">mode of ‘lyshark_dir/’ changed from 0755 (rwxr-xr-x) to 0777 (rwxrwxrwx)</span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># ls -lh lyshark_dir</span></span><br><span class="line">total 0</span><br><span class="line">drwxrwxrwx. 2 root root  6 Nov 17 05:22 lyshark_dir</span><br></pre></td></tr></table></figure></p>
<p><strong>实例2：</strong>使用<code>chmod -R</code>给指定文件的其他人设置rwx权限.<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># ls -lh lyshark_file</span></span><br><span class="line">-rw-r--r--. 1 root root 0 Nov 17 05:22 lyshark_file</span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># chmod o+rwx lyshark_file</span></span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># ls -lh lyshark_file</span></span><br><span class="line">-rw-r--rwx. 1 root root 0 Nov 17 05:22 lyshark_file</span><br></pre></td></tr></table></figure></p>
<h3 id="◆chown-更改属主属组◆"><a href="#◆chown-更改属主属组◆" class="headerlink" title="◆chown 更改属主属组◆"></a>◆chown 更改属主属组◆</h3><p>chown命令改变某个文件或目录的所有者和所属的组,该命令可以向某个用户授权,使该用户变成指定文件的所有者或者改变文件所属的组,用户可以是用户或者是用户ID,用户组可以是组名或组ID,文件名可以使由空格分开的文件列表,在文件名中可以包含通配符.</p>
<p>下面,来看一下这个命令的参数.<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># chown  --help</span></span><br><span class="line"></span><br><span class="line">命令语法：[ chown [选项] [属主].[属组] 文件或目录 ]</span><br><span class="line"></span><br><span class="line">        -c              <span class="comment">#显示权限修改过程,但仅显示改变的</span></span><br><span class="line">        -v              <span class="comment">#显示权限修改过程,显示所有过程</span></span><br><span class="line">        -f              <span class="comment">#不显示错误信息</span></span><br><span class="line">        -R              <span class="comment">#递归设置属性</span></span><br><span class="line">        -h              <span class="comment">#只对符号连接的文件作修改</span></span><br></pre></td></tr></table></figure></p>
<p><strong>实例1：</strong>使用<code>chown -Rv</code>给指定文件设置lyshark为属主.<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># ls -lh lyshark_file</span></span><br><span class="line">-rw-r--rwx. 1 root root 0 Nov 17 05:22 lyshark_file</span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># chown -Rv lyshark lyshark_file</span></span><br><span class="line">changed ownership of ‘lyshark_file’ from root to lyshark</span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># ls -lh lyshark_file</span></span><br><span class="line">-rw-r--rwx. 1 lyshark root 0 Nov 17 05:22 lyshark_file</span><br></pre></td></tr></table></figure></p>
<p><strong>实例2：</strong>使用<code>chown -Rv</code>给指定文件设置lyshark为属组.<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># ls -lh lyshark_file</span></span><br><span class="line">-rw-r--rwx. 1 lyshark root 0 Nov 17 05:22 lyshark_file</span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># chown -Rv .lyshark lyshark_file</span></span><br><span class="line">changed ownership of ‘lyshark_file’ from lyshark:root to :lyshark</span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># ls -lh lyshark_file</span></span><br><span class="line">-rw-r--rwx. 1 lyshark lyshark 0 Nov 17 05:22 lyshark_file</span><br></pre></td></tr></table></figure></p>
<h3 id="◆umask-设置默认掩码◆"><a href="#◆umask-设置默认掩码◆" class="headerlink" title="◆umask 设置默认掩码◆"></a>◆umask 设置默认掩码◆</h3><p>umask命令用来设置限制新建文件权限的掩码,当新文件被创建时,其最初的权限由文件创建掩码决定,用户每次注册进入系统时,umask命令都被执行,并自动设置掩码mode来限制新文件的权限,用户可以通过再次执行umask命令来改变默认值,新的权限将会把旧的覆盖掉.</p>
<p>下面,来看一下这个命令的参数.<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># umask --hlep</span></span><br><span class="line"></span><br><span class="line">命令语法：[ <span class="built_in">umask</span> [选项] [u=rwx] [g=rwx] [o=rwx] ]</span><br><span class="line"></span><br><span class="line">        -p              <span class="comment">#输出的权限掩码可直接作为指令来执行</span></span><br><span class="line">        -S              <span class="comment">#以符号方式输出权限掩码</span></span><br></pre></td></tr></table></figure></p>
<p><strong>实例1：</strong>使用<code>umask</code>设置系统的默认Umask值.<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># umask -S</span></span><br><span class="line">u=rwx,g=rwx,o=rwx</span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># umask u=rwx,g=rw,o=r</span></span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># umask -S</span></span><br><span class="line">u=rwx,g=rw,o=r</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h2 id="Linux-文件特殊权限"><a href="#Linux-文件特殊权限" class="headerlink" title="Linux 文件特殊权限"></a>Linux 文件特殊权限</h2><p>Linux的特殊权限主要有,SUID,SGID,SBIG这三种,其主要作用会在下面加以说明.</p>
<h3 id="◆Set-UID-文件权限◆"><a href="#◆Set-UID-文件权限◆" class="headerlink" title="◆Set UID 文件权限◆"></a>◆Set UID 文件权限◆</h3><p>SetUID：当一个具有执行权限的文件设置SetUID权限后,用户执行这个文件时,将以文件所有者的身份执行.</p>
<p>为了更加清楚的了解这个特性,我们打个比方,普通用户根本没有修改/etc/passwd和/etc/shadow的权利,但是它还是可以通过passwd命令修改自己的密码,这就与SUID这个权限有关啦</p>
<blockquote>
<p>SetUID 权限的特点:</p>
<blockquote>
<p>1.只有可以执行的二进制程序才能设定SUID权限<br>2.命令执行者要对该程序拥有x（执行）权限<br>3.命令执行者在执行该程序时获得该程序文件属主的身份（在执行程序的过程中灵魂附体为文件的属主）<br>4.SetUID权限只在该程序执行过程中有效，也就是说身份改变只在程序执行过程中有效</p>
</blockquote>
</blockquote>
<p>那么如何设置SGID权限呢? 很简单,看下面的两个小例子.<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># ls -l</span></span><br><span class="line">total 16</span><br><span class="line">-rwxr-xr-x 1 root root 8464 Jun 21 18:05 lyshark     <span class="comment">#这是一个可执行文件,SUID只能设置在可执行文件上,且执行者要对此文件拥有x权限</span></span><br><span class="line">-rw-r--r-- 1 root root   46 Jun 21 18:05 lyshark.c</span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># chmod u+s ./lyshark              #设置方法也很简单只需要u+s即可</span></span><br><span class="line">[root@localhost ~]<span class="comment"># chmod 4755 lyshark               #或者</span></span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># ls -l</span></span><br><span class="line">total 16</span><br><span class="line">-rwsr-xr-x 1 root root 8464 Jun 21 18:05 lyshark    <span class="comment">#看吧在权限上多出一个 s</span></span><br><span class="line">-rw-r--r-- 1 root root   46 Jun 21 18:05 lyshark.c</span><br></pre></td></tr></table></figure></p>
<h3 id="◆Set-GID-目录权限◆"><a href="#◆Set-GID-目录权限◆" class="headerlink" title="◆Set GID 目录权限◆"></a>◆Set GID 目录权限◆</h3><p>SetGID：如果可执行二进制文件需要读取一个数据文件,恰巧他们在一个组里,而二进制文件拥有SGID属性,则他们就可以直接访问.</p>
<p>为了更加清楚的了解这个特性,我们打个比方,普通用户在具有SGID的目录里创建文件时,文件的属组都会变成父目录的属组,其作用是方便组内其他成员的操作.</p>
<blockquote>
<p>SetGID 针对文件的作用:</p>
<blockquote>
<p>1.只有可执行的二进制程序才能设置SGID权限<br>2.命令执行者要对该程序拥有x（执行）权限<br>3.命令执行在执行程序的时候，组身份升级为该程序文件的属组<br>4.SetGID权限同样只在该程序执行过程中有效，也就是说组身份改变只在程序执行过程中有效</p>
</blockquote>
</blockquote>
<blockquote>
<p>SetGID 针对目录的作用:</p>
<blockquote>
<p>1.普通用户必须对此目录拥有r和x权限，才能进入此目录<br>2.普通用户在此目录中的有效组会变成此目录的属组<br>3.普通用户对此目录拥有w权限时，新建的文件的默认属组是这个目录的属组</p>
</blockquote>
</blockquote>
<p>那么如何设置SGID权限呢? 很简单,看下面的两个小例子.<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># ls -l</span></span><br><span class="line">total 4</span><br><span class="line">drwxrwxrwx 2 root root 4096 Jun 21 18:19 lyshark</span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># chmod g+s lyshark/        #设置SGID属性</span></span><br><span class="line">[root@localhost ~]<span class="comment"># chmod 2644 lyshark/       #这样也可以</span></span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># ls -l</span></span><br><span class="line">total 4</span><br><span class="line">drwxrwsrwx 2 root root 4096 Jun 21 18:19 lyshark  <span class="comment">#看吧在权限上多出一个 s</span></span><br></pre></td></tr></table></figure></p>
<h3 id="◆Set-BIT-黏着权限◆"><a href="#◆Set-BIT-黏着权限◆" class="headerlink" title="◆Set BIT 黏着权限◆"></a>◆Set BIT 黏着权限◆</h3><p>SetBID：黏着位只能对目录有效,在设置了黏着位的目录下,只能删除自己创建的文件,其他人创建的文件只能浏览,root除外.</p>
<p>讲白了说,就是除了Root能够删除别人创建的文件,否则其他人只能删除自己创建的文件.</p>
<blockquote>
<p>SetBID 针对目录的作用:</p>
<blockquote>
<p>1.粘着位目前只对目录有效<br>2.普通用户对该目录拥有w和x权限,即普通用户可以在此目录拥有写入权限<br>3.赋予了粘着位后除了root可以删除所有文件,普通用户就算拥有w权限,也只能删除自己建立的文件,但是不能删除其他用户建立的文件</p>
</blockquote>
</blockquote>
<p>那么如何设置SBIT权限呢? 很简单,看下面的两个小例子.<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># ls -l</span></span><br><span class="line">total 4</span><br><span class="line">drwxr-xr-x 2 root root 4096 Jun 21 18:25 lyshark</span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># chmod 1644 lyshark/</span></span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># ls -l</span></span><br><span class="line">total 4</span><br><span class="line">drw-r--r-T 2 root root 4096 Jun 21 18:25 lyshark     <span class="comment">#看吧在权限上多出一个 s</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h2 id="Linux-文件隐藏权限"><a href="#Linux-文件隐藏权限" class="headerlink" title="Linux 文件隐藏权限"></a>Linux 文件隐藏权限</h2><p>文件的隐藏属性有,chattr/lsattr,这些隐藏的属性确实对于系统有很大的帮助的,尤其是在系统安全(Security)上面,不过要先强调的是,chattr命令只能在Ext3/Ext4的文件系统上面生效,其他的文件系统可能就无法支持这个命令了,接下来我们就来谈一谈如何配置与检查这些隐藏的属性吧.</p>
<h3 id="◆chattr-设置隐藏属性◆"><a href="#◆chattr-设置隐藏属性◆" class="headerlink" title="◆chattr 设置隐藏属性◆"></a>◆chattr 设置隐藏属性◆</h3><p>chattr命令用来改变文件属性,这项指令可改变存放在ext3/ext4文件系统上的文件或目录属性,下面我们来看一下它的配置参数吧.<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># chattr --help</span></span><br><span class="line"></span><br><span class="line">命令语法：[ chattr [+-=] [状态] [选项] 文件或目录 ]</span><br><span class="line"></span><br><span class="line">        p              <span class="comment">#输出的权限掩码可直接作为指令来执行</span></span><br><span class="line">        A              <span class="comment">#锁定(atime)访问时间</span></span><br><span class="line">        S              <span class="comment">#异步写入磁盘(sync)</span></span><br><span class="line">        a              <span class="comment">#设置只能添加数据,不能删除和修改</span></span><br><span class="line">        c              <span class="comment">#自动将此文件压缩,需要时自动解压缩</span></span><br><span class="line">        d              <span class="comment">#在dump备份时,不会备份此文件</span></span><br><span class="line">        i              <span class="comment">#将文件设置为只读</span></span><br><span class="line">        s              <span class="comment">#文件被删除将永久移除</span></span><br><span class="line">        u              <span class="comment">#文件删除不永久移除</span></span><br><span class="line"></span><br><span class="line">        -R             <span class="comment">#递归处理,连同子目录一起生效</span></span><br><span class="line">        -V             <span class="comment">#显示指令执行过程</span></span><br></pre></td></tr></table></figure></p>
<p><strong>实例1：</strong>将/lyshark目录设置为只能增加不能删除<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost /]<span class="comment"># chattr +a /lyshark/</span></span><br><span class="line"></span><br><span class="line">[root@localhost /]<span class="comment"># cd /lyshark/</span></span><br><span class="line"></span><br><span class="line">[root@localhost lyshark]<span class="comment"># mkdir hello</span></span><br><span class="line">[root@localhost lyshark]<span class="comment"># rm -fr hello/</span></span><br><span class="line">rm: cannot remove hello/: Operation not permitted</span><br></pre></td></tr></table></figure></p>
<p>这个命令是很重要的,尤其是在系统的数据安全上面,由于这些属性是隐藏的性质,所以需要以 lsattr 才能看到该属性,其中个人认为最重要的当属 +i 与 +a 这个属性了,+i可以让一个文件无法被更动,对于需要强烈的系统安全的人来说真是相当的重要,里头还有相当多的属性是需要 root 才能配置的.</p>
<h3 id="◆lsattr-查询隐藏属性◆"><a href="#◆lsattr-查询隐藏属性◆" class="headerlink" title="◆lsattr 查询隐藏属性◆"></a>◆lsattr 查询隐藏属性◆</h3><p>使用 chattr 配置后可以利用 lsattr 来查阅隐藏的属性,lsattr经常使用的几个选项-D,-E,-R这三个选项不可以一起使用,它们是互斥的,经常使用的还有-l,-H,使用lsattr时必须指出具体的设备名,用-l选项指出要显示设备的逻辑名称,否则要用-c,-s,-t等选项唯一的确定某个已存在的设备.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># lsattr --help</span></span><br><span class="line"></span><br><span class="line">命令语法：[ lsattr [选项] 文件或目录 ]</span><br><span class="line"></span><br><span class="line">        -R             <span class="comment">#递归显示权限</span></span><br><span class="line">        -V             <span class="comment">#显示指令的版本信息</span></span><br><span class="line">        -a             <span class="comment">#列出目录中的所有文件,包括隐藏文件.</span></span><br></pre></td></tr></table></figure>
<p><strong><em>实例1：</em></strong>显示刚才配置的选项<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># lsattr -a /lyshark/</span></span><br><span class="line">-----a---------- /lyshark/.</span><br><span class="line">---------------- /lyshark/..</span><br><span class="line">---------------- /lyshark/wang</span><br><span class="line">---------------- /lyshark/hello</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h2 id="Linux-ACL-权限控制"><a href="#Linux-ACL-权限控制" class="headerlink" title="Linux ACL 权限控制"></a>Linux ACL 权限控制</h2><p>ACL 是 Access Control List 的缩写,主要的目的是在提供传统的 owner,group,others 的 read,write,execute 权限之外的细致权限配置,ACL 可以针对单一使用者,单一文件或目录来进行 r,w,x 的权限规范,对于需要特殊权限的使用状况非常有帮助.</p>
<blockquote>
<p>那 ACL 主要可以针对哪些方面来控制权限呢？他主要可以针对几个项目:</p>
<blockquote>
<p>使用属主 (user)：可以针对使用者来配置权限<br>使用属主 (group)：针对群组为对象来配置其权限<br>默认属性 (mask)：还可以针对在该目录下在创建新文件/目录时,规范新数据的默认权限</p>
</blockquote>
</blockquote>
<h3 id="◆acl-权限检测与开启◆"><a href="#◆acl-权限检测与开启◆" class="headerlink" title="◆acl 权限检测与开启◆"></a>◆acl 权限检测与开启◆</h3><p>由于 ACL 是传统的 Unix-like 操作系统权限的额外支持项目,因此要使用 ACL 必须要有文件系统的支持才行,目前绝大部分的文件系统都有支持 ACL 的功能,包括 ReiserFS, EXT2/EXT3, JFS, XFS 等等,在我们的 redhat 7 当中,默认使用 ext4 是启动 ACL 支持的,至于察看你的文件系统是否支持 ACL 可以这样看：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># dumpe2fs -h /dev/vdb</span></span><br><span class="line">dumpe2fs 1.42.9 (28-Dec-2013)</span><br><span class="line">Filesystem volume name:   &lt;none&gt;</span><br><span class="line">Last mounted on:          /ghost</span><br><span class="line">Filesystem UUID:          7b34e434-7e98-4480-9699-afef29afed2f</span><br><span class="line">Filesystem magic number:  0xEF53</span><br><span class="line">Filesystem revision <span class="comment">#:    1 (dynamic)</span></span><br><span class="line">Filesystem features:      has_journal ext_attr resize_inode dir_index...</span><br><span class="line">Filesystem flags:         signed_directory_hash </span><br><span class="line">--------------------------------------------------------------------</span><br><span class="line">Default mount options:    user_xattr acl     <span class="comment">#看到这句话说明开启了</span></span><br><span class="line">--------------------------------------------------------------------</span><br><span class="line">Filesystem state:         clean</span><br><span class="line">Errors behavior:          Continue</span><br><span class="line">Filesystem OS <span class="built_in">type</span>:       Linux</span><br><span class="line">Inode count:              1310720</span><br></pre></td></tr></table></figure>
<p>如果你的系统默认不会帮你加上 acl 的支持呢,那你可以这样做,来手动开启ACL：</p>
<p>假定指定分区没有开启ACL我们可以重新挂载指定分区,并添加ACL权限<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># mount -o remove,acl /dev/vdb</span></span><br></pre></td></tr></table></figure></p>
<p>以上方法只是临时生效,如果想要永久生效则需要写入 /etc/fstab</p>
<p>a.首先我们找到/dev/vdb的UUID号<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># ll /dev/disk/by-uuid/</span></span><br><span class="line">total 0</span><br><span class="line">lrwxrwxrwx 1 root root  9 Jun 17 15:40 7b34e434-7e98-4480-9699-afef29afed2f -&gt; ../../vdb</span><br></pre></td></tr></table></figure></p>
<p>b.然后将它写入/etc/fstab文件里,写入以下虚线内部分<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># /etc/fstab</span></span><br><span class="line"><span class="comment"># Created by anaconda on Sun Oct 15 15:19:00 2017</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment"># Accessible filesystems, by reference, are maintained under '/dev/disk'</span></span><br><span class="line"><span class="comment"># See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line">--------------------------------------------------------------------</span><br><span class="line">UUID=7b34e434-7e98-4480-9699-afef29afed2f /ghost                  ext4    defaults,acl    1 1</span><br><span class="line">--------------------------------------------------------------------</span><br></pre></td></tr></table></figure></p>
<h3 id="◆getfacl-查看ACL权限◆"><a href="#◆getfacl-查看ACL权限◆" class="headerlink" title="◆getfacl 查看ACL权限◆"></a>◆getfacl 查看ACL权限◆</h3><p>getfacl命令主要用来查询指定目录的权限,下面我们来看一下它的参数说明：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># getfacl --help</span></span><br><span class="line"></span><br><span class="line">命令语法：[ getfacl [选项] 文件或目录 ]</span><br><span class="line"></span><br><span class="line">        -p              <span class="comment">#输出的权限掩码可直接作为指令来执行</span></span><br><span class="line">        -a              <span class="comment">#显示访问控制列表</span></span><br><span class="line">        -d              <span class="comment">#只显示默认访问控制列表</span></span><br><span class="line">        -c              <span class="comment">#忽略标题,只显示权限</span></span><br><span class="line">        -R              <span class="comment">#递归显示子目录</span></span><br><span class="line">        -t              <span class="comment">#以表格形式输出</span></span><br><span class="line">        -n              <span class="comment">#打印属主属组UID/GID</span></span><br></pre></td></tr></table></figure></p>
<p>接下来看一个输出结果,具体解释一下输出说明.<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost /]<span class="comment"># getfacl lyshark</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># file: lyshark          #说明文件名称</span></span><br><span class="line"><span class="comment"># owner: root           #说明文件的所有者</span></span><br><span class="line"><span class="comment"># group: root           #说明文件的所属组</span></span><br><span class="line"></span><br><span class="line">user::rw-               <span class="comment">#用户列表是空的,代表所有者的权限</span></span><br><span class="line">group::r--              <span class="comment">#针对用户组的权限设置</span></span><br><span class="line">other::r--              <span class="comment">#针对其他人的权限设置</span></span><br><span class="line">mask::r-x               <span class="comment">#此文件默认有效权限(mask)</span></span><br></pre></td></tr></table></figure></p>
<p>上面的数据非常容易查阅吧,显示的数据前面加上 # 的,代表这个文件的默认属性,包括文件名、文件拥有者与文件所属群组,底下出现的 user,group,mask,other 则是属于不同使用者、群组与有效权限(mask)的配置值.</p>
<h3 id="◆setfacl-设置ACL权限◆"><a href="#◆setfacl-设置ACL权限◆" class="headerlink" title="◆setfacl 设置ACL权限◆"></a>◆setfacl 设置ACL权限◆</h3><p>setfacl命令是用来在命令行里设置ACL (访问控制列表) 在命令行里,一系列的命令跟随以一系列的文件名.</p>
<p>setfacl命令主要用来设置指定目录的权限,下面我们来看一下它的参数说明：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># setfacl --help</span></span><br><span class="line"></span><br><span class="line">命令语法：[ setfacl [选项][ugo]:[用户][rwx] 文件或目录 ]</span><br><span class="line"></span><br><span class="line">        -m              <span class="comment">#添加ACL权限,不可与-x合用</span></span><br><span class="line">        -x              <span class="comment">#删除某用户的ACL权限,不可与-m合用</span></span><br><span class="line">        -b              <span class="comment">#清空所有ACL权限</span></span><br><span class="line"></span><br><span class="line">        -R              <span class="comment">#递归配置ACL,实现目录上ACL权限的递归</span></span><br><span class="line">        -d              <span class="comment">#设置默认ACL权限(传承)</span></span><br><span class="line">        -k              <span class="comment">#删除默认ACL权限参数</span></span><br></pre></td></tr></table></figure></p>
<h3 id="◆acl-权限配置小例子◆"><a href="#◆acl-权限配置小例子◆" class="headerlink" title="◆acl 权限配置小例子◆"></a>◆acl 权限配置小例子◆</h3><p><strong><em>添加ACL权限：</em></strong>添加lyshark用户对root目录的rwx权限<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># setfacl -m u:lyshark:rwx /root/</span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># getfacl /root/</span></span><br><span class="line"><span class="comment"># file: root/</span></span><br><span class="line"><span class="comment"># owner: root</span></span><br><span class="line"><span class="comment"># group: root</span></span><br><span class="line">user::r-x</span><br><span class="line">user:lyshark:rwx    <span class="comment">#此处可以看到,用户这里多出来了lyshark用户,此时lyshark用户可以任意操作/root目录下的文件</span></span><br><span class="line">group::r-x</span><br><span class="line">mask::rwx</span><br><span class="line">other::---</span><br></pre></td></tr></table></figure></p>
<p><strong><em>删除ACL权限：</em></strong>删除lyshark用户对root目录的rwx权限<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># setfacl -x u:lyshark /root/</span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># getfacl /root/</span></span><br><span class="line"><span class="comment"># file: root/</span></span><br><span class="line"><span class="comment"># owner: root</span></span><br><span class="line"><span class="comment"># group: root</span></span><br><span class="line">user::r-x           <span class="comment">#此处可以看到,用户lyshark的权限已被撤销了,此时再次访问/root目录会出现权限拒绝</span></span><br><span class="line">group::r-x</span><br><span class="line">mask::r-x</span><br><span class="line">other::---</span><br></pre></td></tr></table></figure></p>
<p><strong><em>清空所有ACL权限：</em></strong>清空指定目录或文件的所有ACL配置<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># setfacl -b /root/</span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># getfacl /root/</span></span><br><span class="line"><span class="comment"># file: root/</span></span><br><span class="line"><span class="comment"># owner: root</span></span><br><span class="line"><span class="comment"># group: root</span></span><br><span class="line">user::r-x</span><br><span class="line">group::r-x</span><br><span class="line">other::---</span><br></pre></td></tr></table></figure></p>
<p><strong><em>递归设置ACL权限：</em></strong>实现对目录上的ACL权限的递归设置(目录)<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># setfacl -R -m u:lyshark:rwx /root/</span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># getfacl /root/</span></span><br><span class="line"><span class="comment"># file: root/</span></span><br><span class="line"><span class="comment"># owner: root</span></span><br><span class="line"><span class="comment"># group: root</span></span><br><span class="line">user::r-x</span><br><span class="line">user:lyshark:rwx</span><br><span class="line">group::r-x</span><br><span class="line">mask::rwx</span><br><span class="line">other::---</span><br><span class="line"></span><br><span class="line"><span class="comment">#注释：如果不递归设置,那么普通用户无法在子目录下进行读写执行</span></span><br></pre></td></tr></table></figure></p>
<p><strong><em>对空目录设置默认ACL：</em></strong>添加lyshark用户对/root目录的rwx权限,并且在/root目录下新建的文件lyshark用户都有rwx权限<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># setfacl -d -m u:lyshark:rwx /root/</span></span><br><span class="line">[root@localhost ~]<span class="comment"># setfacl -m d:u:lyshark:rwx /root/</span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># getfacl /root/</span></span><br><span class="line"><span class="comment"># file: root/</span></span><br><span class="line"><span class="comment"># owner: root</span></span><br><span class="line"><span class="comment"># group: root</span></span><br><span class="line">user::r-x</span><br><span class="line">group::r-x</span><br><span class="line">mask::r-x</span><br><span class="line">other::---</span><br><span class="line">default:user::r-x</span><br><span class="line">default:user:lyshark:rwx   <span class="comment">#这边可以看到lyshark的默认权限是rwx，root用户不管创建什么文件都有权限</span></span><br><span class="line">default:group::r-x</span><br><span class="line">default:mask::rwx</span><br><span class="line">default:other::---</span><br></pre></td></tr></table></figure></p>
<p><strong><em>对非空目录设置默认ACL：</em></strong>添加lyshark用户对/root目录的rwx权限,并且在/root目录下新建的文件lyshark用户都有rwx权限<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># setfacl -R -m u:lyshark:rwx /root/   #递归设置ACL权限</span></span><br><span class="line">[root@localhost ~]<span class="comment"># setfacl -d -m u:lyshark:rwx /root/   #设置默认ACL权限</span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># getfacl /root/</span></span><br><span class="line"><span class="comment"># file: root/</span></span><br><span class="line"><span class="comment"># owner: root</span></span><br><span class="line"><span class="comment"># group: root</span></span><br><span class="line">user::r-x</span><br><span class="line">user:lyshark:rwx</span><br><span class="line">group::r-x</span><br><span class="line">mask::rwx</span><br><span class="line">other::---</span><br><span class="line">default:user::r-x</span><br><span class="line">default:user:lyshark:rwx</span><br><span class="line">default:group::r-x</span><br><span class="line">default:mask::rwx</span><br><span class="line">default:other::---</span><br></pre></td></tr></table></figure></p>
<p><strong><em>设置最大有效权限mask(目录)：</em></strong>为/root目录设置添加最大默认权限为rx,其他ACL权限不得超出此权限<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># setfacl -m m:rx /root/</span></span><br><span class="line">[root@localhost ~]<span class="comment"># </span></span><br><span class="line">[root@localhost ~]<span class="comment"># getfacl /root/</span></span><br><span class="line"><span class="comment"># file: root/</span></span><br><span class="line"><span class="comment"># owner: root</span></span><br><span class="line"><span class="comment"># group: root</span></span><br><span class="line">user::r-x</span><br><span class="line">user:lyshark:rwx        <span class="comment">#effective:r-x    #虽然lyshark对root目录有rwx权限,但是我们设置了最大有效权限,所以lyshark用户只能读和执行</span></span><br><span class="line">group::r-x</span><br><span class="line">mask::r-x                                 <span class="comment">#最大有效权限r-x</span></span><br><span class="line">other::---</span><br><span class="line">default:user::r-x</span><br><span class="line">default:user:lyshark:rwx</span><br><span class="line">default:group::r-x</span><br><span class="line">default:mask::rwx</span><br><span class="line">default:other::---</span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h2 id="Linux-Sudo-用户授权"><a href="#Linux-Sudo-用户授权" class="headerlink" title="Linux Sudo 用户授权"></a>Linux Sudo 用户授权</h2><p>sudo是linux系统管理指令,是允许系统管理员让普通用户执行一些或者全部的root命令的一个工具,如halt,reboot,su等,这样不仅减少了root用户的登录,和管理时间,同样也提高了安全性,sudo不是对shell的一个代替,它是面向每个命令的.</p>
<p>sudo命令用来以其他身份来执行命令,预设的身份为root,在/etc/sudoers中设置了可执行sudo指令的用户,若其未经授权的用户企图使用sudo,则会发出警告的邮件给管理员,用户使用sudo时,必须先输入密码,之后有5分钟的有效期限,超过期限则必须重新输入密码.</p>
<blockquote>
<p>为什么会出现sudo授权?</p>
<blockquote>
<p>首先在Linux的管理中,不是每一个系统管理员都能用root来管理服务器</p>
</blockquote>
</blockquote>
<blockquote>
<p>Sudo的优缺点是什么?</p>
<blockquote>
<p>平时使用普通用户管理操作系统,降低误操作几率,需要时su切换到root.<br>su用户身份的切换,普通管理员要使用root的权限必须知道root的密码,这样会造成很多普通用户需要知道root的密码,导致系统的安全性降低.<br>sudo可以为普通用户赋予一定权限,使普通用户能使用一些root才能执行的命令和操作,来完成正常的服务器管理工作,这种按需分配权限的方式可以让我们工作在一个相对安全的环境下,并且普通用户不需要知道root的密码.</p>
</blockquote>
</blockquote>
<blockquote>
<p>Sudo工作步骤,或者说执行流程?</p>
<blockquote>
<p>a.通过visudo命令或者vim /etc/sudoers 来对某用户授权<br>b.当普通用户执行/sbin或/usr/sbin下的命令时,系统会查询/etc/sudoers文件中是否有root对其的授权<br>c.当查询普通用户已拥有授权后,需要输入普通用户的密码来确认用户身份<br>d.若密码输入成功后,则执行对应已经授权的命令</p>
</blockquote>
</blockquote>
<p>下面来看一下sudo命令的常用参数吧：<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># sudo --help</span></span><br><span class="line"></span><br><span class="line">命令语法：[ sudo [选项] 授权用户 ]</span><br><span class="line"></span><br><span class="line">        -b              <span class="comment">#在后台执行指令</span></span><br><span class="line">        -H              <span class="comment">#将HOME环境变量设为新身份的HOME环境变量</span></span><br><span class="line">        -k              <span class="comment">#结束密码的有效期限,也就是下次再执行sudo时便需要输入密码</span></span><br><span class="line">        -l              <span class="comment">#列出目前用户可执行与无法执行的指令</span></span><br><span class="line">        -p              <span class="comment">#改变询问密码的提示符号</span></span><br><span class="line">        -s shell        <span class="comment">#执行指定的shell</span></span><br><span class="line">        -u 用户         <span class="comment">#以指定的用户作为新的身份,若不加上此参数,则预设以root作为新的身份</span></span><br><span class="line">        -v              <span class="comment">#延长密码有效期限5分钟</span></span><br></pre></td></tr></table></figure></p>
<p><strong>实例1：</strong>给lyshark用户授予root的所有命令<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /etc/sudoers</span><br><span class="line"></span><br><span class="line"><span class="comment">## The COMMANDS section may have other options added to it.</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## Allow root to run any commands anywhere </span></span><br><span class="line">root    ALL=(ALL)       ALL     </span><br><span class="line">lyshark ALL=(ALL)       ALL   <span class="comment">#写入以下参数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## Allows members of the 'sys' group to run networking, software,</span></span><br></pre></td></tr></table></figure></p>
<p><strong>实例2：</strong>授权lyshark用户只可以重启服务器<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /etc/sudoers</span><br><span class="line"></span><br><span class="line"><span class="comment">## The COMMANDS section may have other options added to it.</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## Allow root to run any commands anywhere</span></span><br><span class="line">root    ALL=(ALL)       ALL</span><br><span class="line">lyshark ALL=(ALL)       /sbin/shutdown -r now   <span class="comment">#写入以下参数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## Allows members of the 'sys' group to run networking, software,</span></span><br></pre></td></tr></table></figure></p>
<p><strong>实例3：</strong>授权lyshark用户仅可以管理192.168.1.10的服务器：可以使用Apache管理脚本<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /etc/sudoers</span><br><span class="line"></span><br><span class="line"><span class="comment">## The COMMANDS section may have other options added to it.</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## Allow root to run any commands anywhere</span></span><br><span class="line">root    ALL=(ALL)       ALL</span><br><span class="line">lyshark 192.168.1.10=(ALL)  /etc/rc.d/init.d/httpd reload,/etc/rc.d/init.d/httpd configtest   <span class="comment">#写入以下参数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## Allows members of the 'sys' group to run networking, software,</span></span><br></pre></td></tr></table></figure></p>
<p><strong>实例4：</strong>授权lyshark用户,可以修改Apache配置文件<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /etc/sudoers</span><br><span class="line"></span><br><span class="line"><span class="comment">## The COMMANDS section may have other options added to it.</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## Allow root to run any commands anywhere</span></span><br><span class="line">root    ALL=(ALL)       ALL</span><br><span class="line">lyshark ALL=(ALL)       /bin/vim,/etc/httpd/conf/httpd.conf   <span class="comment">#写入以下参数</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## Allows members of the 'sys' group to run networking, software,</span></span><br></pre></td></tr></table></figure></p>
<p><strong>实例5：</strong>授权lyshark用户可以添加普通用户并能修改密码<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">vim /etc/sudoers</span><br><span class="line"></span><br><span class="line"><span class="comment">## The COMMANDS section may have other options added to it.</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## Allow root to run any commands anywhere</span></span><br><span class="line">root    ALL=(ALL)       ALL</span><br><span class="line">lyshark ALL=(ALL)       /usr/sbin/useradd                                              <span class="comment">#让lyshark用户可以创建普通用户</span></span><br><span class="line">lyshark ALL=(ALL)       /usr/bin/passwd,!/usr/bin/passwd root,!/usr/bin/passwd <span class="string">""</span>      <span class="comment">#让lyshark用户可以给新用户改密码,但不允许修改root用户的密码</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## Allows members of the 'sys' group to run networking, software,</span></span><br></pre></td></tr></table></figure></p>
<p><br></p>
<h2 id="Linux-PAM-模块简介"><a href="#Linux-PAM-模块简介" class="headerlink" title="Linux PAM 模块简介"></a>Linux PAM 模块简介</h2><p>PAM 可以说是一套应用程序编程接口(Application Programming Interface,API)他提供了一连串的验证机制,只要使用者将验证阶段的需求告知 PAM 后,PAM 就能够回报使用者验证的结果(成功或失败),由于 PAM 仅是一套验证的机制,又可以提供给其他程序所呼叫引用,因此不论你使用什么程序,都可以使用 PAM 来进行验证,如此一来,就能够让账号口令或者是其他方式的验证具有一致的结果,也让程序设计师方便处理验证的问题.</p>
<p>PAM 是一个独立的 API 存在,只要任何程序有需求时,可以向 PAM 发出验证要求的通知, PAM 经过一连串的验证后,将验证的结果回报给该程序,然后该程序就能够利用验证的结果来进行可登陆或显示其他无法使用的信息.</p>
<p>PAM 用来进行验证的数据称为模块 (Modules) 每个 PAM 模块的功能都不太相同,举例来说,使用 passwd 命令时,如果随便输入字典上面找的到的字符串 passwd 就会回报错误信息了,这就是 PAM 的 pam_cracklib.so 模块的功能,他能够判断该口令是否在字典里面,并回报给口令修改程序,此时就能够了解你的口令强度了.</p>
<blockquote>
<p>以运行passwd命令为例,我们来说明一下,系统是如何调用PAM验证的.</p>
<blockquote>
<p>1.用户开始运行 /usr/bin/passwd 程序,并输入口令.<br>2.passwd 调用PAM模块进行验证.<br>3.PAM 模块会到 /etc/pam.d/ 找寻与程序 (passwd) 同名的配置文件.<br>4.依据 /etc/pam.d/passwd 内的配置，引用相关的 PAM 模块逐步进行验证分析.<br>5.将验证结果 (成功、失败以及其他信息) 回传给 passwd 这个程序<br>6.passwd 程序会根据 PAM 回传的结果决定下一个动作 (重新输入新口令或者通过验证)</p>
</blockquote>
</blockquote>
<p>从上面的说明,我们会知道重点其实是 /etc/pam.d/ 里面的配置文件,以及配置文件所调用的 PAM 模块进行的验证工作,既然一直谈到 passwd 这个口令修改命令,那我们就来看看 /etc/pam.d/passwd 这个配置文件的内容是怎样吧<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># cat /etc/pam.d/passwd</span></span><br><span class="line"><span class="comment">#%PAM-1.0</span></span><br><span class="line"></span><br><span class="line">[验证类别] [控制标准]   [PAM 模块与该模块的参数]</span><br><span class="line">auth       include      system-auth            &lt;==每一行都是一个验证的过程</span><br><span class="line">account    include      system-auth</span><br><span class="line">password   substack     system-auth</span><br><span class="line">-password   optional    pam_gnome_keyring.so use_authtok</span><br><span class="line">password   substack     postlogin</span><br></pre></td></tr></table></figure></p>
<p>在这个配置文件当中,除了第一行 PAM 版本之外,其他任何『 # 』开头的都是批注,而每一行都是一个独立的验证流程,每一行可以区分为三个字段,分别是验证类别(type)、控制标准(flag)、PAM的模块与该模块的参数,在我们上面的表格当中出现的是『 include (包括) 』这个关键词,他代表的是『使用后面的文件作为验证方式』 所以,上述的每一行都要重复调用 /etc/pam.d/system-auth 那个文件来进行验证的意思.<br><br></p>
<h2 id="Linux-SELinux-权限配置"><a href="#Linux-SELinux-权限配置" class="headerlink" title="Linux SELinux 权限配置"></a>Linux SELinux 权限配置</h2><p>SELinux 是由美国国家安全局 (NSA) 开发的,当初开发这玩意儿的目的是因为很多企业界发现,通常系统出现问题的原因大部分都在于『内部员工的资源误用』所导致的,实际由外部发动的攻击反而没有这么严重,面对这样的处境NSA开始着手研究了这个项目,由于是在Linux上做的研发,因此它们便把自己的研究成果整合到了Linux里面来了,SELinux 是整合到内核的一个模块这也就是说：其实 SELinux 是在进行程序、文件等权限配置依据的一个核心模块.</p>
<p><strong>传统的文件权限与帐号关系：自主访问控制,DAC</strong></p>
<p>系统的帐号主要分为系统管理员(root)与一般用户,而这两种身份能否使用系统上面的文件资源则与rwx的权限配置有关,不过你要注意的是,各种权限配置对root是无效的,因此当某个程序想要对文件进行存取时,系统就会根据该程序的权限并比对文件的权限,若通过权限检查,就可以存取该文件了,这种存取文件系统的方式被称为 『自主式存取控制 (Discretionary Access Control,DAC)』 ,基本上就是依据程序的拥有者与文件资源的rwx权限来决定有无存取的能力,不过这种 DAC 的存取控制有几个困扰,那就是:</p>
<blockquote>
<p>1.root具有最高的权限：如果不小心某个程序被有心人士取得,且该程序属于root的权限,那么这个程序就可以在系统上进行任何资源的存取,可想而知它的危险性.</p>
</blockquote>
<blockquote>
<p>2.使用者可以取得程序来变更文件资源的存取权限：如果你不小心将某个目录的权限配置为 777,由于对任何人的权限会变成rwx,因此该目录就会被任何人所任意存取.</p>
</blockquote>
<p>这些问题是非常严重的 ! 尤其是当你的系统是被某些漫不经心的系统管理员所掌控时,她们甚至觉得目录权限调为 777 也没有什么了不起的.</p>
<p><strong>以策略规则制定特定程序读取特定文件：委托访问控制,MAC</strong></p>
<p>委托访问控制 (MAC) 他可以针对特定的程序与特定的文件资源来进行权限的控制,也就是说,即使你是root那么在使用不同的程序时,你所能取得的权限并不一定是root,而得要看当时该程序的配置而定,如此一来,我们针对控制的『主体』变成了『程序』而不是使用者.</p>
<p>下面呢,我们来看一下Selinux的几个字段,并且分别解释一下它的含义吧.</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># ls -lZ</span></span><br><span class="line"></span><br><span class="line">drwxr-xr-x. root root root:object_r:admin_home_t:s0 lyshark_dir</span><br><span class="line">-rw-r--r--. root root system_u:object_r:passwd_file_t:s0 passwd</span><br><span class="line">                        ↑           ↑         ↑</span><br><span class="line">                        Identify    Role      Type（最重要）</span><br></pre></td></tr></table></figure>
<blockquote>
<p>身份识别 (Identify)</p>
<blockquote>
<p>root：表示 root 的帐号身份<br>system_u：表示系统程序方面的标识,通常是进程<br>user_u：代表一般用户账号相关身份</p>
</blockquote>
</blockquote>
<blockquote>
<p>角色段 (Role)</p>
<blockquote>
<p>object_r：代表的是文件或目录等文件资源<br>system_r：代表的就是进程,不过一般用户也会被指明system_r</p>
</blockquote>
</blockquote>
<blockquote>
<p>类型 (Type)</p>
<blockquote>
<p>type：在文件资源(Object)上面称为类型(Type)<br>domain：在主体程序(Subject)则称为域(domain)</p>
</blockquote>
</blockquote>
<h3 id="◆SeLinux的启动关闭与查询◆"><a href="#◆SeLinux的启动关闭与查询◆" class="headerlink" title="◆SeLinux的启动关闭与查询◆"></a>◆SeLinux的启动关闭与查询◆</h3><p><strong>查询SeLinux状态</strong></p>
<p>查询我们可以使用以下命令,首先老样子,先看一下命令可用参数吧.<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># sestatus --help</span></span><br><span class="line"></span><br><span class="line">命令语法：[ sestatus [选项] ]</span><br><span class="line"></span><br><span class="line">        -v              <span class="comment">#检查位于/etc/sestatus.conf内文件的安全上下文</span></span><br><span class="line">        -b              <span class="comment">#将目前策略规则的布尔值列出</span></span><br></pre></td></tr></table></figure></p>
<p><strong>临时开启SeLinux</strong><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># getenforce</span></span><br><span class="line">Enforcing</span><br><span class="line">[root@localhost ~]<span class="comment"># setenforce 1</span></span><br></pre></td></tr></table></figure></p>
<p><strong>永久开启SeLinux</strong><br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># cat /etc/selinux/config</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># This file controls the state of SELinux on the system.</span></span><br><span class="line"><span class="comment"># SELINUX= can take one of these three values:</span></span><br><span class="line"><span class="comment">#     enforcing - SELinux security policy is enforced.</span></span><br><span class="line"><span class="comment">#     permissive - SELinux prints warnings instead of enforcing.</span></span><br><span class="line"><span class="comment">#     disabled - No SELinux policy is loaded.</span></span><br><span class="line">SELINUX= permissive   ← 改成enforcing</span><br><span class="line"><span class="comment"># SELINUXTYPE= can take one of three two values:</span></span><br><span class="line"><span class="comment">#     targeted - Targeted processes are protected,</span></span><br><span class="line"><span class="comment">#     minimum - Modification of targeted policy. Only selected processes are protected.</span></span><br><span class="line"><span class="comment">#     mls - Multi Level Security protection.</span></span><br><span class="line">SELINUXTYPE=targeted</span><br></pre></td></tr></table></figure></p>
<h3 id="◆设置与恢复SeLinux安全上下文◆"><a href="#◆设置与恢复SeLinux安全上下文◆" class="headerlink" title="◆设置与恢复SeLinux安全上下文◆"></a>◆设置与恢复SeLinux安全上下文◆</h3><p><strong>chcon 设置上下文</strong></p>
<p>chcon命令是修改对象(文件)的安全上下文,比如：用户、角色、类型、安全级别,也就是将每个文件上下文变更为指定的上下文,chcon命令位于/usr/bin/chcon,下面就来看一下它的参数吧.<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># chcon --help</span></span><br><span class="line"></span><br><span class="line">命令语法：[ chcon [选项] [上下文] 文件或目录 ]</span><br><span class="line"></span><br><span class="line">        -R              <span class="comment">#递归设置目录的权限</span></span><br><span class="line">        -t              <span class="comment">#设置安全上下文,例如(httpd_sys_content_t)</span></span><br><span class="line">        -u              <span class="comment">#后面接身份标识,例如(system_u)</span></span><br><span class="line">        -r              <span class="comment">#后面接角色,例如(system_r)</span></span><br></pre></td></tr></table></figure></p>
<p><strong>实例1：</strong>给指定文件设置一个amba_share_t安全上下文.<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># ls -lZ</span></span><br><span class="line">drwxr-xr-x. root root unconfined_u:object_r:admin_home_t:s0 lyshark_dir</span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># chcon -R -t samba_share_t lyshark_dir/</span></span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># ls -lZ</span></span><br><span class="line">drwxr-xr-x. root root unconfined_u:object_r:samba_share_t:s0 lyshark_dir</span><br></pre></td></tr></table></figure></p>
<p><strong>实例2：</strong>依照/etc/passwd为模板,修改lyshark_dir目录的安全上下文.<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># ls -lZ</span></span><br><span class="line">drwxr-xr-x. root root unconfined_u:object_r:samba_share_t:s0 lyshark_dir</span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># chcon -R --reference=/etc/passwd lyshark_dir/</span></span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># ls -lZ</span></span><br><span class="line">drwxr-xr-x. root root system_u:object_r:passwd_file_t:s0 lyshark_dir</span><br></pre></td></tr></table></figure></p>
<p><strong>restorecon 恢复上下文</strong></p>
<p>restorecon命令用来恢复SELinux文件属性即恢复文件的安全上下文,当我们配置错误时,可以使用此命令恢复一下,看一下参数吧.<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># restorecon --help</span></span><br><span class="line"></span><br><span class="line">命令语法：[ restorecon [选项] 文件或目录 ]</span><br><span class="line"></span><br><span class="line">        -R              <span class="comment">#递归设置目录的权限</span></span><br><span class="line">        -v              <span class="comment">#显示执行过程</span></span><br></pre></td></tr></table></figure></p>
<p><strong>实例1：</strong> 将上面的文件上下文,全部恢复到默认状态.<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># ls -lZ</span></span><br><span class="line">drwxr-xr-x. root root system_u:object_r:passwd_file_t:s0 lyshark_dir</span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># restorecon -R lyshark_dir/</span></span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># ls -lZ</span></span><br><span class="line">drwxr-xr-x. root root system_u:object_r:admin_home_t:s0 lyshark_dir</span><br></pre></td></tr></table></figure></p>
<h3 id="◆SeLinux策略查询与布尔值管理◆"><a href="#◆SeLinux策略查询与布尔值管理◆" class="headerlink" title="◆SeLinux策略查询与布尔值管理◆"></a>◆SeLinux策略查询与布尔值管理◆</h3><p>如果我们不知道策略的规则,那我们也很难设置规则,下面我们就来看一下如何查询到我们想要的策略吧.</p>
<p><strong>seinfo 查询策略</strong></p>
<p>通过Yum仓库,快速安装seinfo<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># yum install -y setools-libs setools-console</span></span><br><span class="line"></span><br><span class="line">Loaded plugins: product-id, search-disabled-repos, subscription-manager</span><br><span class="line">This system is not registered with an entitlement server. You can use subscription-manager.</span><br><span class="line">Package setools-libs-3.3.8-2.el7.x86_64 already installed and latest version</span><br><span class="line">Package setools-console-3.3.8-2.el7.x86_64 already installed and latest version</span><br><span class="line">Nothing to <span class="keyword">do</span></span><br></pre></td></tr></table></figure></p>
<p>其次我们来看一下它的配置参数吧.<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># seinfo --help</span></span><br><span class="line"></span><br><span class="line">命令语法：[ seinfo [选项] ]</span><br><span class="line"></span><br><span class="line">        -A              <span class="comment">#列出所有,规则布尔值,角色,类型等.</span></span><br><span class="line">        -t              <span class="comment">#列出所有类型(type)</span></span><br><span class="line">        -r              <span class="comment">#列出所有角色(role)</span></span><br><span class="line">        -u              <span class="comment">#列出所有身份标识(user)</span></span><br><span class="line">        -b              <span class="comment">#列出所有规则种类(布尔值)</span></span><br></pre></td></tr></table></figure></p>
<p><strong>实例：</strong>利用<code>seinfo -b</code>命令查询所有与httpd相关的规则.<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># seinfo -b |grep httpd_use</span></span><br><span class="line">   httpd_use_fusefs</span><br><span class="line">   httpd_use_openstack</span><br><span class="line">   httpd_use_nfs</span><br><span class="line">   httpd_use_sasl</span><br><span class="line">   httpd_use_gpg</span><br><span class="line">   httpd_use_cifs</span><br></pre></td></tr></table></figure></p>
<p><strong>布尔值的查询与修改</strong></p>
<p><strong>查询：</strong>通过<code>getsebool -a</code>查询<code>httpd_use_openstack</code>的状态.<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># getsebool -a |grep httpd_use_openstack</span></span><br><span class="line">httpd_use_openstack --&gt; off</span><br></pre></td></tr></table></figure></p>
<p><strong>修改：</strong>通过<code>setsebool -P [0|1]</code>开启<code>httpd_use_openstack</code>状态.<br><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">[root@localhost ~]<span class="comment"># getsebool -a |grep httpd_use_openstack</span></span><br><span class="line">httpd_use_openstack --&gt; off</span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># setsebool -P httpd_use_openstack=1</span></span><br><span class="line"></span><br><span class="line">[root@localhost ~]<span class="comment"># getsebool -a |grep httpd_use_openstack</span></span><br><span class="line">httpd_use_openstack --&gt; on</span><br></pre></td></tr></table></figure></p>
<p><br></p>

      
    </div>

    

<!--增加的底部版权代码-->
<div>
      
        
<div class="my_post_copyright">
  <p><span>本文标题:</span><a href="/2018/11/17/Linux 系统管理/Linux系统文件权限管理-6/">Linux系统文件权限管理(6)</a></p>
  <p><span>文章作者:</span><a href="/" title="访问 王瑞 的个人博客">王瑞</a></p>
  <p><span>发布时间:</span>2018年11月17日 - 09:11</p>
  <p><span>最后更新:</span>2019年04月16日 - 20:04</p>
  <p><span>原始链接:</span><a href="/2018/11/17/Linux 系统管理/Linux系统文件权限管理-6/" title="Linux系统文件权限管理(6)">https://www.mkdirs.com/2018/11/17/Linux 系统管理/Linux系统文件权限管理-6/</a>
  </p>
  <p><span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">署名-非商业性使用-禁止演绎 4.0 国际</a> 转载请保留原文链接及作者</p>
</div>

      
</div>
    
    
    

    

    
      
    
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Linux-系统管理/" rel="tag"> <i class="fa fa-tag"></i> Linux 系统管理</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/11/16/Linux 系统管理/Linux系统文件压缩与备份-5/" rel="next" title="Linux系统文件压缩与备份(5)">
                <i class="fa fa-chevron-left"></i> Linux系统文件压缩与备份(5)
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/11/18/Linux 系统管理/Linux系统磁盘与分区管理-7/" rel="prev" title="Linux系统磁盘与分区管理(7)">
                Linux系统磁盘与分区管理(7) <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.jpg" alt="王瑞">
            
              <p class="site-author-name" itemprop="name">王瑞</p>
              <div class="site-description motion-element" itemprop="description">记录点滴技术成长之路</div>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">101</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  
                    
                      <a href="/categories/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">11</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  
                    
                      <a href="/tags/">
                    
                  
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">13</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                  
                    
                  
                  <a href="https://github.com/lyshark" title="GitHub &rarr; https://github.com/lyshark" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i></a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                  
                    
                  
                  <a href="mailto:1181506874@qq.com" title="E-Mail &rarr; mailto:1181506874@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i></a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                  
                    
                  
                  <a href="https://plus.google.com/lyshark" title="Google &rarr; https://plus.google.com/lyshark" rel="noopener" target="_blank"><i class="fa fa-fw fa-google"></i></a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                  
                    
                  
                  <a href="https://twitter.com/lyshark" title="Twitter &rarr; https://twitter.com/lyshark" rel="noopener" target="_blank"><i class="fa fa-fw fa-twitter"></i></a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                  
                    
                  
                  <a href="http://wpa.qq.com/msgrd?v=3&uin=1181506874&site=hupaiyule&menu=yes" title="QQ &rarr; http://wpa.qq.com/msgrd?v=3&uin=1181506874&site=hupaiyule&menu=yes" rel="noopener" target="_blank"><i class="fa fa-fw fa-qq"></i></a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                  
                    
                  
                  <a href="https://weixin.qq.com" title="Wechat &rarr; https://weixin.qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-weixin"></i></a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#Linux-文件普通权限"><span class="nav-text">Linux 文件普通权限</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#◆chmod-更改目录权限◆"><span class="nav-text">◆chmod 更改目录权限◆</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#◆chown-更改属主属组◆"><span class="nav-text">◆chown 更改属主属组◆</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#◆umask-设置默认掩码◆"><span class="nav-text">◆umask 设置默认掩码◆</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Linux-文件特殊权限"><span class="nav-text">Linux 文件特殊权限</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#◆Set-UID-文件权限◆"><span class="nav-text">◆Set UID 文件权限◆</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#◆Set-GID-目录权限◆"><span class="nav-text">◆Set GID 目录权限◆</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#◆Set-BIT-黏着权限◆"><span class="nav-text">◆Set BIT 黏着权限◆</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Linux-文件隐藏权限"><span class="nav-text">Linux 文件隐藏权限</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#◆chattr-设置隐藏属性◆"><span class="nav-text">◆chattr 设置隐藏属性◆</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#◆lsattr-查询隐藏属性◆"><span class="nav-text">◆lsattr 查询隐藏属性◆</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Linux-ACL-权限控制"><span class="nav-text">Linux ACL 权限控制</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#◆acl-权限检测与开启◆"><span class="nav-text">◆acl 权限检测与开启◆</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#◆getfacl-查看ACL权限◆"><span class="nav-text">◆getfacl 查看ACL权限◆</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#◆setfacl-设置ACL权限◆"><span class="nav-text">◆setfacl 设置ACL权限◆</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#◆acl-权限配置小例子◆"><span class="nav-text">◆acl 权限配置小例子◆</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Linux-Sudo-用户授权"><span class="nav-text">Linux Sudo 用户授权</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Linux-PAM-模块简介"><span class="nav-text">Linux PAM 模块简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Linux-SELinux-权限配置"><span class="nav-text">Linux SELinux 权限配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#◆SeLinux的启动关闭与查询◆"><span class="nav-text">◆SeLinux的启动关闭与查询◆</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#◆设置与恢复SeLinux安全上下文◆"><span class="nav-text">◆设置与恢复SeLinux安全上下文◆</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#◆SeLinux策略查询与布尔值管理◆"><span class="nav-text">◆SeLinux策略查询与布尔值管理◆</span></a></li></ol></li></ol></div>
            

          </div>
        </div>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>
  


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">

<!-- 屏蔽版权开始 -->
&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">王瑞</span>
<!-- 屏蔽版权结束 -->

  

  
</div>









        








        
      </div>
    </footer>

    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=7.0.1"></script>

  <script src="/js/src/motion.js?v=7.0.1"></script>



  
  


  <script src="/js/src/affix.js?v=7.0.1"></script>

  <script src="/js/src/schemes/pisces.js?v=7.0.1"></script>




  
  <script src="/js/src/scrollspy.js?v=7.0.1"></script>
<script src="/js/src/post-details.js?v=7.0.1"></script>



  


  <script src="/js/src/next-boot.js?v=7.0.1"></script>


  

  

  

  


  


  




  

  

  

  

  

  

  

  

  

  

  

  

  

  

</body>
</html>
